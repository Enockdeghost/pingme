{% extends "base.html" %}

{% block title %}Book a Ride - RideShare Pro{% endblock %}

{% block extra_css %}
<style>
    .booking-container {
        max-width: 800px;
        margin: 0 auto;
    }

    .booking-header {
        text-align: center;
        margin-bottom: 2rem;
    }

    .booking-header h1 {
        font-size: 2rem;
        margin-bottom: 0.5rem;
    }

    .booking-header p {
        color: var(--text-secondary);
    }

    .map-container {
        height: 300px;
        background-color: var(--surface-color);
        border-radius: 0.75rem;
        margin-bottom: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid var(--border-color);
    }

    .map-placeholder {
        text-align: center;
        color: var(--text-secondary);
    }

    .ride-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .ride-option {
        background-color: var(--surface-color);
        border: 1px solid var(--border-color);
        border-radius: 0.75rem;
        padding: 1.5rem;
        cursor: pointer;
        transition: all 0.2s;
    }

    .ride-option:hover {
        border-color: var(--primary-color);
    }

    .ride-option.selected {
        border-color: var(--primary-color);
        background-color: rgba(37, 99, 235, 0.05);
    }

    .ride-icon {
        width: 48px;
        height: 48px;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: rgba(37, 99, 235, 0.1);
        border-radius: 50%;
    }

    .ride-icon svg {
        width: 24px;
        height: 24px;
        color: var(--primary-color);
    }

    .ride-name {
        font-weight: 600;
        margin-bottom: 0.5rem;
    }

    .ride-price {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--primary-color);
    }

    .ride-details {
        font-size: 0.875rem;
        color: var(--text-secondary);
    }

    .booking-form {
        background-color: var(--surface-color);
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }
        
        .ride-options {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="booking-container">
    <div class="booking-header">
        <h1>Book a Ride</h1>
        <p>Get where you need to go, safely and affordably</p>
    </div>

    <div class="map-container">
        <div class="map-placeholder">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M12 11C13.1046 11 14 10.1046 14 9C14 7.89543 13.1046 7 12 7C10.8954 7 10 7.89543 10 9C10 10.1046 10.8954 11 12 11Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            <p class="mt-2">Interactive map would appear here</p>
        </div>
    </div>

    <div class="ride-options">
        <div class="ride-option selected" data-type="economy">
            <div class="ride-icon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16 3H8C6.34315 3 5 4.34315 5 6V18C5 19.6569 6.34315 21 8 21H16C17.6569 21 19 19.6569 19 18V6C19 4.34315 17.6569 3 16 3Z" stroke="currentColor" stroke-width="2"/>
                    <path d="M5 9H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M7 5V7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M17 5V7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </div>
            <div class="ride-name">Economy</div>
            <div class="ride-price">TZS 5,000</div>
            <div class="ride-details">Affordable everyday rides</div>
        </div>

        <div class="ride-option" data-type="comfort">
            <div class="ride-icon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 17H20C20.5523 17 21 17.4477 21 18V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V18C3 17.4477 3.44772 17 4 17H5" stroke="currentColor" stroke-width="2"/>
                    <path d="M17 21V13C17 11.8954 16.1046 11 15 11H9C7.89543 11 7 11.8954 7 13V21" stroke="currentColor" stroke-width="2"/>
                    <path d="M7 5L12 3L17 5V9H7V5Z" stroke="currentColor" stroke-width="2"/>
                </svg>
            </div>
            <div class="ride-name">Comfort</div>
            <div class="ride-price">TZS 8,000</div>
            <div class="ride-details">Extra legroom & newer cars</div>
        </div>

        <div class="ride-option" data-type="premium">
            <div class="ride-icon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 17H20C20.5523 17 21 17.4477 21 18V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V18C3 17.4477 3.44772 17 4 17H5" stroke="currentColor" stroke-width="2"/>
                    <path d="M17 21V13C17 11.8954 16.1046 11 15 11H9C7.89543 11 7 11.8954 7 13V21" stroke="currentColor" stroke-width="2"/>
                    <path d="M7 5L12 3L17 5V9H7V5Z" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 8V11" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M14.5 9.5H9.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </div>
            <div class="ride-name">Premium</div>
            <div class="ride-price">TZS 12,000</div>
            <div class="ride-details">Top-rated drivers & luxury cars</div>
        </div>
    </div>

    <div class="booking-form">
        <form id="bookingForm">
            <div class="form-group">
                <label for="pickup" class="form-label">Pickup Location</label>
                <input type="text" id="pickup" class="form-control" placeholder="Enter pickup address" required>
            </div>

            <div class="form-group">
                <label for="destination" class="form-label">Destination</label>
                <input type="text" id="destination" class="form-control" placeholder="Enter destination address" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="date" class="form-label">Date</label>
                    <input type="date" id="date" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="time" class="form-label">Time</label>
                    <input type="time" id="time" class="form-control" required>
                </div>
            </div>

            <div class="form-group">
                <label for="payment" class="form-label">Payment Method</label>
                <select id="payment" class="form-control" required>
                    <option value="">Select payment method</option>
                    <option value="cash">Cash</option>
                    <option value="card">Credit/Debit Card</option>
                    <option value="mobile">Mobile Money</option>
                </select>
            </div>

            <div class="form-group">
                <label for="notes" class="form-label">Special Instructions (Optional)</label>
                <textarea id="notes" class="form-control" rows="3" placeholder="Any special instructions for your driver"></textarea>
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%;">Confirm Booking</button>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Ride option selection
    document.querySelectorAll('.ride-option').forEach(option => {
        option.addEventListener('click', function() {
            document.querySelectorAll('.ride-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            this.classList.add('selected');
        });
    });

    // Booking form submission
    document.getElementById('bookingForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const selectedRide = document.querySelector('.ride-option.selected');
        const rideType = selectedRide ? selectedRide.dataset.type : 'economy';
        
        const formData = {
            pickup: document.getElementById('pickup').value,
            destination: document.getElementById('destination').value,
            date: document.getElementById('date').value,
            time: document.getElementById('time').value,
            payment: document.getElementById('payment').value,
            notes: document.getElementById('notes').value,
            rideType: rideType
        };
        
        // Show loading animation
        document.getElementById('loading').classList.remove('hidden');
        
        // Simulate API call
        setTimeout(function() {
            // Hide loading animation
            document.getElementById('loading').classList.add('hidden');
            
            // In a real app, you would handle the API response here
            console.log('Booking request:', formData);
            
            // For demo purposes, show success message
            alert('Ride booked successfully! A driver will be assigned shortly.');
            
            // Redirect to ride tracking page
            window.location.href = '/ride/tracking';
        }, 2000);
    });

    // Set default date and time to current
    const now = new Date();
    document.getElementById('date').value = now.toISOString().split('T')[0];
    document.getElementById('time').value = now.toTimeString().slice(0, 5);
</script>
{% endblock %}